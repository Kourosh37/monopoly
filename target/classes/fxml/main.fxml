<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.monopoly.gui.controllers.MainController"
            styleClass="main-container"
            prefWidth="1500" prefHeight="950"
            fx:id="mainContainer">

    <!-- Top: Menu Bar -->
    <top>
        <VBox>
            <MenuBar styleClass="menu-bar">
                <Menu text="ðŸŽ® Game">
                    <MenuItem text="New Game" fx:id="newGameMenuItem" onAction="#handleNewGame"/>
                    <MenuItem text="Join Game" fx:id="joinGameMenuItem" onAction="#handleJoinGame"/>
                    <SeparatorMenuItem/>
                    <MenuItem text="Save Game" fx:id="saveGameMenuItem" onAction="#handleSaveGame"/>
                    <MenuItem text="Load Game" fx:id="loadGameMenuItem" onAction="#handleLoadGame"/>
                    <SeparatorMenuItem/>
                    <MenuItem text="Exit" onAction="#handleExit"/>
                </Menu>
                <Menu text="âš™ Settings">
                    <MenuItem text="Sound Settings" onAction="#handleSoundSettings"/>
                    <MenuItem text="Display Settings" onAction="#handleDisplaySettings"/>
                </Menu>
                <Menu text="â“ Help">
                    <MenuItem text="How to Play" onAction="#handleHowToPlay"/>
                    <MenuItem text="Rules" onAction="#handleRules"/>
                    <SeparatorMenuItem/>
                    <MenuItem text="About" onAction="#handleAbout"/>
                </Menu>
            </MenuBar>
        </VBox>
    </top>

    <!-- Left: Player Panels -->
    <left>
        <VBox fx:id="playerPanelContainer" styleClass="player-panel" spacing="10" prefWidth="280">
            <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
            
            <Label text="PLAYERS" styleClass="action-section-title"/>
            
            <!-- Player cards will be added dynamically -->
            <VBox fx:id="playerCardsContainer" spacing="10">
            </VBox>
        </VBox>
    </left>

    <!-- Center: Game Board -->
    <center>
        <StackPane fx:id="boardContainer" styleClass="board-container">
            <padding><Insets topRightBottomLeft="15"/></padding>
            
            <!-- The board will be rendered by BoardController -->
            <GridPane fx:id="boardGrid" alignment="CENTER">
            </GridPane>
            
            <!-- Center area with Monopoly logo and game info -->
            <VBox fx:id="boardCenter" styleClass="board-center" alignment="CENTER" spacing="20"
                  maxWidth="400" maxHeight="400">
                <padding><Insets topRightBottomLeft="20"/></padding>
                
                <Label text="MONOPOLY" styleClass="monopoly-logo"/>
                
                <!-- Dice Display -->
                <HBox fx:id="diceContainer" styleClass="dice-container" alignment="CENTER" spacing="20">
                    <StackPane fx:id="dice1" styleClass="dice" prefWidth="60" prefHeight="60">
                        <Label fx:id="dice1Value" text="?" style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                    </StackPane>
                    <StackPane fx:id="dice2" styleClass="dice" prefWidth="60" prefHeight="60">
                        <Label fx:id="dice2Value" text="?" style="-fx-font-size: 24px; -fx-font-weight: bold;"/>
                    </StackPane>
                </HBox>
                
                <Label fx:id="diceTotal" text="" styleClass="dice-total"/>
                
                <!-- Roll Button -->
                <Button fx:id="rollDiceButton" text="ðŸŽ² ROLL DICE" styleClass="roll-dice-button"
                        onAction="#handleRollDice"/>
                
                <!-- Game Status -->
                <Label fx:id="gameStatusLabel" text="Waiting for players..." 
                       style="-fx-text-fill: #b0b0b0; -fx-font-size: 14px;"/>
                
                <!-- Community Chest / Chance Card Display -->
                <StackPane fx:id="cardDisplayPane" visible="false" managed="false"
                           maxWidth="200" maxHeight="120">
                    <Rectangle width="200" height="120" arcWidth="15" arcHeight="15"
                               style="-fx-fill: #1a1a2e; -fx-stroke: #e94560; -fx-stroke-width: 2;"/>
                    <VBox alignment="CENTER" spacing="5">
                        <Label fx:id="cardTypeLabel" text="CHANCE" 
                               style="-fx-font-size: 12px; -fx-text-fill: #e94560; -fx-font-weight: bold;"/>
                        <Label fx:id="cardTextLabel" text="" 
                               style="-fx-font-size: 11px; -fx-text-fill: #ffffff; -fx-wrap-text: true; -fx-text-alignment: center;"
                               wrapText="true" maxWidth="180"/>
                    </VBox>
                </StackPane>
            </VBox>
        </StackPane>
    </center>

    <!-- Right: Action Panel -->
    <right>
        <VBox fx:id="actionPanel" styleClass="action-panel" spacing="15" prefWidth="280">
            <padding><Insets top="15" right="15" bottom="15" left="15"/></padding>
            
            <!-- Current Turn Info -->
            <VBox styleClass="action-section" spacing="10">
                <Label text="CURRENT TURN" styleClass="action-section-title"/>
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Circle fx:id="currentPlayerToken" radius="15" styleClass="player-token"/>
                    <VBox spacing="2">
                        <Label fx:id="currentPlayerName" text="Player 1" styleClass="player-name"/>
                        <Label fx:id="currentPlayerMoney" text="1500" styleClass="player-money"/>
                    </VBox>
                </HBox>
            </VBox>
            
            <!-- Property Actions -->
            <VBox styleClass="action-section" spacing="10">
                <Label text="PROPERTY ACTIONS" styleClass="action-section-title"/>
                <GridPane styleClass="action-button-grid" hgap="8" vgap="8">
                    <Button text="Buy" fx:id="buyPropertyButton" onAction="#handleBuyProperty"
                            GridPane.columnIndex="0" GridPane.rowIndex="0" prefWidth="115"/>
                    <Button text="Auction" fx:id="auctionButton" onAction="#handleStartAuction"
                            GridPane.columnIndex="1" GridPane.rowIndex="0" prefWidth="115"/>
                    <Button text="Build House" fx:id="buildHouseButton" onAction="#handleBuildHouse"
                            GridPane.columnIndex="0" GridPane.rowIndex="1" prefWidth="115"/>
                    <Button text="Build Hotel" fx:id="buildHotelButton" onAction="#handleBuildHotel"
                            GridPane.columnIndex="1" GridPane.rowIndex="1" prefWidth="115"/>
                    <Button text="Mortgage" fx:id="mortgageButton" onAction="#handleMortgage"
                            GridPane.columnIndex="0" GridPane.rowIndex="2" prefWidth="115"/>
                    <Button text="Unmortgage" fx:id="unmortgageButton" onAction="#handleUnmortgage"
                            GridPane.columnIndex="1" GridPane.rowIndex="2" prefWidth="115"/>
                </GridPane>
            </VBox>
            
            <!-- Trade & Other Actions -->
            <VBox styleClass="action-section" spacing="10">
                <Label text="OTHER ACTIONS" styleClass="action-section-title"/>
                <Button text="ðŸ’± Propose Trade" fx:id="tradeButton" onAction="#handleTrade"
                        styleClass="button-secondary" prefWidth="240"/>
                <Button text="ðŸ  View Properties" fx:id="viewPropertiesButton" onAction="#handleViewProperties"
                        prefWidth="240"/>
            </VBox>
            
            <!-- Jail Actions (shown when in jail) -->
            <VBox fx:id="jailActionsPane" styleClass="action-section" spacing="10" visible="false" managed="false">
                <Label text="JAIL OPTIONS" styleClass="action-section-title"/>
                <Button text="Pay 50 Fine" fx:id="payJailFineButton" onAction="#handlePayJailFine"
                        styleClass="button-warning" prefWidth="240"/>
                <Button text="Use Get Out Free Card" fx:id="useJailCardButton" onAction="#handleUseJailCard"
                        prefWidth="240"/>
                <Label fx:id="jailTurnsLabel" text="Turns in jail: 0/3" 
                       style="-fx-text-fill: #ff9800; -fx-font-size: 12px;"/>
            </VBox>
            
            <!-- End Turn -->
            <Region VBox.vgrow="ALWAYS"/>
            <Button text="âœ“ END TURN" fx:id="endTurnButton" onAction="#handleEndTurn"
                    styleClass="button-success" prefWidth="240" prefHeight="45"/>
        </VBox>
    </right>

    <!-- Bottom: Log Panel & Status Bar -->
    <bottom>
        <VBox>
            <!-- Game Log -->
            <VBox fx:id="logPanel" styleClass="log-panel" prefHeight="120">
                <Label text="GAME LOG" style="-fx-text-fill: #6c7a89; -fx-font-size: 11px; -fx-font-weight: bold;"/>
                <ScrollPane fitToWidth="true" styleClass="log-list" VBox.vgrow="ALWAYS">
                    <VBox fx:id="logEntriesContainer" spacing="2">
                    </VBox>
                </ScrollPane>
            </VBox>
            
            <!-- Status Bar -->
            <HBox styleClass="status-bar" alignment="CENTER_LEFT" spacing="20">
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <Circle fx:id="connectionIndicator" radius="5" styleClass="status-indicator status-disconnected"/>
                    <Label fx:id="connectionStatus" text="Disconnected" styleClass="status-text"/>
                </HBox>
                <Region HBox.hgrow="ALWAYS"/>
                <Label fx:id="roomInfoLabel" text="" styleClass="status-text"/>
                <Label fx:id="turnInfoLabel" text="" styleClass="status-text"/>
            </HBox>
        </VBox>
    </bottom>

</BorderPane>
